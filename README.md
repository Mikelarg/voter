# Voter
## _Тестовое задание с опросником_


### Установка

```sh
git clone https://github.com/Mikelarg/voter.git voter
cd voter
docker-compose up -d --build
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py createsuperuser
```

И направляйтесь сюда http://127.0.0.1:8000/api/

### API
**Значения у которых стоит звездочка(\*) — обязательны**
#### Аутентификация
Чтобы получить доступ к методам API для администратора потребуется добавить 
в Headers запроса следующий Header
Authorization: Token <Токен администратора>

Чтобы получить токен надо запросить его по пути /api/api-token-auth/
с следующим содержимым 
```json
{
	"username": "Юзернейм*",
	"password": "Пароль*"
}
```
#### Опросы
Находится по /api/polls/
Доступно только от имени администратора
Доступные значения
```json
{
    "id": "id опроса (неизменяемый)",
    "title": "Заголовок опроса*",
    "description": "Описание опроса",
    "start_date": "Дата старта (после создание изменять нельзя!)*",
    "end_date": "Дата окончания*",
    "questions": "Список с объектами вопросов (неизменяемый)"
}
```
#### Вопросы (без общего списка)
Находится по /api/questions/
Доступно только от имени администратора
Доступные значения
```json
{
    "id": "id вопроса (неизменяемый)",
    "poll": "id опроса к которому относится вопрос*",
    "question_text": "Текст вопроса*",
    "question_type": "Тип вопроса. Возможные значения ANSWER_WITH_TEXT, ANSWER_SINGLE_CHOICE, ANSWER_MULTIPLE_CHOICE*",
    "choices": [{ // Список с объектами ответов (изменяемый)
            "id": "id ответа (неизменяемый)(не обезательный во время создания)",
            "choice_text": "Текст ответа*"
    }], 
}
```
#### Варианты ответов (без общего списка)
Находится по /api/choices/
Доступно только от имени администратора
Доступные значения
```json
{
    "id": "id ответа (неизменяемый)(не обезательный во время создания)",
    "choice_text": "Текст ответа*",
    "question": "id вопроса к которому принадлежит ответ*"
}
```
#### Голосование
Находится по /api/vote/
Доступные значения
```json
{
    "poll": "id опроса на который отвечает пользователь*",
    "votes": [{ // Список с ответами на вопросы
        "question": "id вопроса*",
        "answer": "текст ответа",
        "choices": [] // Список с id ответов на вопросы
    }]
}
```
* **answer** — обязателен в случае, если у вопроса тип **ANSWER_WITH_TEXT**
* **choices** — обязателен в случае, если у вопроса типы **ANSWER_SINGLE_CHOICE** или **ANSWER_MULTIPLE_CHOICE**
#### Получение опросов в которых голосовал пользователь
Находится по /api/voted/<id пользователя>/
```json
{
    "id": "id опроса",
    "title": "Заголовок опроса",
    "description": "Описание опроса",
    "start_date": "Дата старта",
    "end_date": "Дата окончания",
    "questions": [{ // Список с объектами вопросов
        "id": "id вопроса",
        "poll": "id опроса к которому относится вопрос",
        "question_text": "Текст вопроса",
        "question_type": "Тип вопроса",
        "choices": [{ // Список с объектами ответов
            "id": "id ответа",
            "choice_text": "Текст ответа"
        }], 
        "voted": [{ // Ответ пользователя
            "id": "id голоса",
            "answer": "Текст ответа",
            "choices": [] // Список с id ответов
        }]
    }]
}
```
#### Список действующих опросов
Находится по /api/active-polls/

